<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <link rel="icon" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="Games app" />
    <link rel="apple-touch-icon" href="/favicon.svg" />
    <link rel="manifest" href="/manifest.json" />
    <title>Games</title>
    <script defer="defer" src="asset/static/js/auth.js"></script>
    <script defer="defer" src="asset/static/js/wallet.js"></script>
    <script defer="defer" src="asset/static/js/pcWallet.js"></script>
    <script defer="defer" src="asset/static/js/getBalance.js"></script>
    <script>
        // Обработчик сообщений от iframe
        window.addEventListener('message', function(event) {
            if (event.data && event.data.type === 'updateBalance') {
                const balanceElement = document.querySelector('.HeaderBalanceInfo_balance_Gw9TU');
                if (balanceElement) {
                    balanceElement.innerHTML = event.data.balance;
                    console.log('Balance updated in parent window:', event.data.balance);
                }
            }
        });
        </script>
    <script>
        function handleEditBalance() {
          const newBalance = prompt('Enter new balance:');
          if (newBalance === null || newBalance === '') return;
          
          const accessKey = localStorage.getItem('access_key');
          if (!accessKey) {
              alert('Please login first');
              return;
          }
          
          fetch('/update_balance', {
              method: 'POST',
              headers: {
                  'Content-Type': 'application/json',
                  'X-Access-Key': accessKey
              },
              body: JSON.stringify({
                  balance: parseFloat(newBalance)
              })
          })
          .then(response => response.json())
          .then(data => {
              if (data.success) {
                  const walletValue = document.getElementById('walletValue');
                  if (walletValue) {
                      walletValue.textContent = `${data.new_balance} ₽`;
                  }
              } else {
                  alert('Error: ' + data.error);
              }
          })
          .catch(error => {
              console.error('Error:', error);
              alert('Failed to update balance');
          });
        }
      </script>
    <script defer="defer" src="asset/static/js/runtime.22af2a51cfdb2a24933e.js"></script>
    <script defer="defer" src="asset/static/js/main.4cb48290bcd4e9a02429.js"></script>
    <link href="asset/static/css/main.4a7afb73.css" rel="stylesheet">
    <script>
    // Обработчик сообщений от родительского окна
    window.addEventListener('message', function(event) {
        console.log('Received message:', event.data);
        if (event.data && event.data.type === 'setLanguage') {
            console.log('Setting language to:', event.data.lang);
            window.setLanguage(event.data.lang);
        }
    });

    // Сообщаем родителю что мы готовы
    window.onload = function() {
        window.parent.postMessage({
            type: 'iframeReady',
            currentLang: window.currentGameLang
        }, '*');
    };
    </script>
     
    <style>
        /* Фон с размытием */
        .swal2-container {
            backdrop-filter: blur(10px) !important;
            -webkit-backdrop-filter: blur(10px) !important;
            background: rgba(0, 0, 0, 0.2) !important;
        }

        /* Модальное окно */
        .swal2-popup {
            background: rgba(28, 32, 40, 0.8) !important;
            border: 1px solid rgba(255, 255, 255, 0.1) !important;
            padding: 30px !important;
            border-radius: 12px !important;
            width: 320px !important;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4) !important;
            backdrop-filter: blur(4px) !important;
            -webkit-backdrop-filter: blur(4px) !important;
        }

        /* Заголовок */
        .swal2-title {
            font-size: 24px !important;
            color: #fff !important;
            margin-bottom: 20px !important;
            text-align: center !important;
            font-weight: 500 !important;
        }

        /* Поле ввода */
        .swal2-input {
            width: 100% !important;
            padding: 12px !important;
            margin: 10px 0 !important;
            background: rgba(255, 255, 255, 0.05) !important;
            border: 1px solid rgba(255, 255, 255, 0.1) !important;
            border-radius: 6px !important;
            font-size: 16px !important;
            color: #fff !important;
            transition: all 0.2s ease !important;
            box-shadow: none !important;
        }

        .swal2-input:focus {
            outline: none !important;
            border-color: rgba(255, 255, 255, 0.3) !important;
            background: rgba(255, 255, 255, 0.1) !important;
        }

        .swal2-input::placeholder {
            color: rgba(255, 255, 255, 0.3) !important;
        }

        /* Кнопки */
        .swal2-actions {
            margin-top: 20px !important;
        }

        .swal2-confirm {
            width: 100% !important;
            padding: 12px !important;
            background: #2563eb !important;
            border: none !important;
            border-radius: 6px !important;
            color: #fff !important;
            font-size: 16px !important;
            font-weight: 500 !important;
            cursor: pointer !important;
            transition: all 0.2s ease !important;
        }

        .swal2-confirm:hover {
            background: #1d4ed8 !important;
        }

        .swal2-cancel {
            display: none !important; /* Скрываем кнопку отмены */
        }

        /* Сообщения об ошибках */
        .swal2-validation-message {
            background: transparent !important;
            color: #ef4444 !important;
            margin-top: 10px !important;
            text-align: center !important;
            font-size: 14px !important;
            padding: 0 !important;
        }

        /* Анимации */
        .swal2-show {
            animation: modal-show 0.3s ease-out !important;
        }

        @keyframes modal-show {
            0% {
                transform: scale(0.9);
                opacity: 0;
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        .swal2-hide {
            animation: modal-hide 0.2s ease-in !important;
        }

        @keyframes modal-hide {
            0% {
                transform: scale(1);
                opacity: 1;
            }
            100% {
                transform: scale(0.9);
                opacity: 0;
            }
        }

        /* Убираем фоновые элементы иконки успеха */
        .swal2-success-circular-line-left,
        .swal2-success-circular-line-right,
        .swal2-success-fix {
            display: none !important;
        }

        /* Стилизуем иконку успеха */
        .swal2-icon.swal2-success {
            border-color: #2563eb !important;
            background: transparent !important;
        }

        .swal2-icon.swal2-success [class^='swal2-success-line'] {
            background-color: #2563eb !important;
        }

        /* Стилизуем иконку ошибки */
        .swal2-icon.swal2-error {
            border-color: #ef4444 !important;
            background: transparent !important;
        }

        .swal2-icon.swal2-error [class^='swal2-x-mark-line'] {
            background-color: #ef4444 !important;
        }
    </style>
</head>

<body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root">
        <button type="button" class="app-button px-2 mx-2 small cursor-pointer" onclick="handleEditBalance()">
            <div class="flex items-center gap-1">
                <div>
                    <svg width="24" height="24" viewbox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <!-- ... svg path ... -->
                    </svg>
                </div>
                <span id="walletValue">0 $</span>
            </div>
        </button>
    </div>
</body>

</html>


